

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Run SAML compliance tests &mdash; GOV.UK Verify Technical Guide  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="GOV.UK Verify Technical Guide  documentation" href="../../index.html"/>
        <link rel="up" title="SAML" href="saml.html"/>
        <link rel="next" title="Local Matching Service" href="../ms/ms.html"/>
        <link rel="prev" title="Build your service" href="samlIntegration.html"/>
  <link href="../../_static/style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.4/js.cookie.js"></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-54060634-2', 'auto');
    ga('send', 'pageview');

  </script>
  <script type="text/javascript" src="../../_static/CookieBanner.js"></script>
  <script>
    $(function() {new CookieBanner("seen_cookie_message", 28, "ida-cookie-message").launch();});
  </script>


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GOV.UK Verify Technical Guide
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About this guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arch/arch.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steps/steps.html">Steps to integrate GOV.UK Verify into your service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="saml.html">SAML</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="samlWorks.html">How SAML works wth GOV.UK Verify</a></li>
<li class="toctree-l2"><a class="reference internal" href="samlIntegration.html">Build your service</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Run SAML compliance tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#test-your-service-with-the-saml-compliance-tool">Test your service with the SAML compliance tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-your-matching-service-with-the-saml-compliance-tool">Test your matching service with the SAML compliance tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-of-a-json-request-to-your-local-matching-service">Example of a JSON request to your local matching service</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ms/ms.html">Local Matching Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msa/msa.html">Matching Service Adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pki/pki.html">Public Key Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/env.html">GOV.UK Verify environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shared/glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vershis/vershis.html">Version history</a></li>
<li class="toctree-l1"><a class="reference external" href="http://rp-environment-request.ida.digital.cabinet-office.gov.uk/contact_form">Contact us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GOV.UK Verify Technical Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="saml.html">SAML</a> &raquo;</li>
      
    <li>Run SAML compliance tests</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="run-saml-compliance-tests">
<span id="samlcompliancetool"></span><h1>Run SAML compliance tests<a class="headerlink" href="#run-saml-compliance-tests" title="Permalink to this headline">¶</a></h1>
<p>The purpose of SAML compliance tests is to ensure that the service you&#8217;re building is compliant with the <a class="reference external" href="https://www.gov.uk/government/publications/identity-assurance-hub-service-saml-20-profile">SAML profile</a>. This guarantees that:</p>
<ul class="simple">
<li>your service will work with GOV.UK Verify</li>
<li>user data will remain secure within the GOV.UK Verify federation</li>
</ul>
<p>Your service and matching service need to consume and produce SAML messages in a variety of different scenarios. The SAML compliance tool allows you to test and prove that your service and matching service can consume and produce all required SAML messages.</p>
<p>The compliance tool provides clear error messages. These will help with iterative development of your service.  We advise you to use the compliance tool as part of your continuous integration pipeline. This ensures that any changes maintain backwards compatibility.</p>
<p>Prerequisites:</p>
<ul class="simple">
<li><a class="reference internal" href="../ms/msBuild.html#msbuild"><span>build your local matching service</span></a> – you can use the <a class="reference internal" href="../ms/msBuild.html#respondjsonmr"><span>example of the JSON request</span></a> that the Matching Service Adapter posts to your service and the <a class="reference internal" href="../ms/msBuild.html#jsonschema"><span>JSON schema</span></a> for a matching request</li>
<li><a class="reference internal" href="../msa/msaUse.html#msa-install-msa"><span>install</span></a> and <a class="reference internal" href="../msa/msaUse.html#configuremsa"><span>configure</span></a> your Matching Service Adapter</li>
</ul>
<p>Use the SAML compliance test to:</p>
<ul class="simple">
<li><a class="reference internal" href="#samlctservicehub"><span>test your service</span></a></li>
<li><a class="reference internal" href="#samlcthubmsa"><span>test your matching service</span></a></li>
</ul>
<p>After SAML compliance tests, you can run <a class="reference internal" href="../env/envEndToEndTests.html#envendtoendtests"><span>end-to-end testing</span></a> in the integration environment.</p>
<div class="section" id="test-your-service-with-the-saml-compliance-tool">
<span id="samlctservicehub"></span><h2>Test your service with the SAML compliance tool<a class="headerlink" href="#test-your-service-with-the-saml-compliance-tool" title="Permalink to this headline">¶</a></h2>
<p>To use the compliance tool, you need configuration data (see step 4). Generate a new set of configuration data for every test run.</p>
<ol class="arabic simple">
<li>On completion of a successful <a class="reference external" href="http://alphagov.github.io/identity-assurance-documentation/stage3/Stage3.html">Stage 3</a> gate review, your GOV.UK Verify engagement lead will give you access to the compliance tool.</li>
<li>Send the IP addresses of your hosts to the GOV.UK Verify support team: <a class="reference external" href="mailto:idasupport+onboarding&#37;&#52;&#48;digital&#46;cabinet-office&#46;gov&#46;uk">idasupport+onboarding<span>&#64;</span>digital<span>&#46;</span>cabinet-office<span>&#46;</span>gov<span>&#46;</span>uk</a>. We will add a firewall rule allowing access to the compliance tool.</li>
</ol>
<ol class="arabic" id="samlctselfsigncert" start="3">
<li><p class="first">Generate self-signed certificates for use with the compliance tool only. You can use OpenSSL to generate self-signed certificates using the <a class="reference external" href="https://devcenter.heroku.com/articles/ssl-certificate-self#prerequisites">guidelines provided by the Heroku Dev Center</a>.</p>
</li>
<li><p class="first">POST the following JSON (via curl, or similar) to the <code class="docutils literal"><span class="pre">URI</span> <span class="pre">compliance-tool.RPPostUri</span></code> provided by your GOV.UK Verify engagement lead:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Content-Type: application/json
{
    &quot;rpEntityId&quot;:&quot;[entityID for your service - you can use the same URL as the assertionConsumerServiceUrl]&quot;,
    &quot;assertionConsumerServiceUrl&quot;:&quot;[assertion consumer service URL: this is the URL that will consume responses from the GOV.UK Verify hub]&quot;,
    &quot;signingPublicCert&quot;:&quot;[Base64-encoded X509 signing certificate for your service]&quot;,
    &quot;encryptionPublicCert&quot;:&quot;[Base64-encoded X509 encryption certificate for your service]&quot;,
    &quot;expectedPID&quot;:&quot;[expected persistent identifier: this is the user id that the Matching Service Adapter returns in an assertion]&quot;,
    &quot;matchingServiceEntityId&quot;:&quot;[entityID for your Matching Service Adapter]&quot;,
    &quot;matchingServiceSigningPrivateCert&quot;:&quot;[Base64-encoded private signing key for the Matching Service Adapter, see below]&quot;,
    &quot;userAccountCreationAttributes&quot;:&quot;[optional list of attributes the government service requires for new user account creation, see below]&quot;
}
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>Replace the square brackets and their contents with your configuration data, taking account of the following:</p>
<ul>
<li><p class="first">the keys and certificates in the configuration data must be single-line strings of Base64-encoded data without the header and footer <code class="docutils literal"><span class="pre">BEGIN</span> <span class="pre">CERTIFICATE</span></code> and <code class="docutils literal"><span class="pre">END</span> <span class="pre">CERTIFICATE</span></code></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">matchingServiceSigningPrivateCert</span></code>: this is required because the compliance tool sends a response to your service which contains an assertion signed by the Matching Service Adapter</p>
<p>This key must be in PKCS#8 PEM format:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>cat server.crt server.key &gt; server.pem

openssl pkcs8 -nocrypt -in server.pem -out server.pk8.pem -outform PEM -topk8
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">userAccountCreationAttributes</span></code>: provide this only if you want to test <a class="reference internal" href="../ms/msCua.html#ms-cua"><span>new user account creation</span></a> – select from the full <a class="reference internal" href="../ms/msCua.html#list-cua-attributes"><span>list of attributes</span></a></p>
</li>
</ul>
</div></blockquote>
<ol class="arabic" start="5">
<li><p class="first">You receive a response similar to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Status 200 Created
</pre></div>
</div>
</li>
<li><p class="first">Consume the GOV.UK Verify hub&#8217;s metadata from the URL <code class="docutils literal"><span class="pre">compliance-tool.MetadataUri</span></code> provided by your GOV.UK Verify engagement lead. This metadata contains the compliance tool single sign-on (SSO) URI.</p>
</li>
<li><p class="first">Generate an authentication request and POST it to the compliance tool&#8217;s SSO URI. Follow the redirect in the response to retrieve the result.</p>
</li>
<li><p class="first">If the result contains <code class="docutils literal"><span class="pre">PASSED</span></code>, access the URI provided in <code class="docutils literal"><span class="pre">responseGeneratorLocation</span></code>. A list of test scenarios is displayed.</p>
</li>
<li><p class="first">Access the <code class="docutils literal"><span class="pre">executeUri</span></code> for each test scenario you want to execute. The following test scenarios are provided:</p>
</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Basic successful match</li>
<li>Basic no match</li>
<li>No authentication context (this is when the user cancels the process)</li>
<li>Authentication failed</li>
<li>Requester error (this is when the request is invalid)</li>
<li>Account creation</li>
</ul>
<p>The above scenarios are the possible responses for step 8 in the <a class="reference internal" href="samlWorks.html#samlworks"><span>SAML message flow</span></a>.</p>
</div></blockquote>
</div>
<div class="section" id="test-your-matching-service-with-the-saml-compliance-tool">
<span id="samlcthubmsa"></span><h2>Test your matching service with the SAML compliance tool<a class="headerlink" href="#test-your-matching-service-with-the-saml-compliance-tool" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>To set up the SAML compliance tool for matching service tests, POST the following JSON (via curl or similar) to the URL <code class="docutils literal"><span class="pre">&lt;compliance-tool-host&gt;/ms-test-run</span></code> provided by your GOV.UK Verify engagement lead.</li>
</ol>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span></span>Content-Type: application/json
 {
 &quot;matchingServiceEntityId&quot;: &quot;[entityID of the matching service]&quot;,
 &quot;transactionEntityId&quot;: &quot;[entityID of the transaction (service)]&quot;,
 &quot;matchingServiceEndpoint&quot;: &quot;[the matching service&#39;s endpoint]&quot;,
 &quot;matchingServicePublicSigningCert&quot;: &quot;[signing certificate to verify the response]&quot;,
 &quot;matchingServicePublicEncryptionCert&quot;: &quot;[encryption certificate to encrypt the assertions]&quot;
 }
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">You receive a response similar to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Status 201 Created
Location: .../ms-test-run/8fd7782f-efac-48b2-8171-3e4da9553d19
</pre></div>
</div>
</li>
<li><p class="first">POST your test <a class="reference internal" href="../../shared/glossary.html#gloss-mds"><span>matching dataset</span></a> (see example below) to the <code class="docutils literal"><span class="pre">Location</span></code> field in the above response (<code class="docutils literal"><span class="pre">.../ms-test-run/8fd7782f-efac-48b2-8171-3e4da9553d19</span></code> in the above example).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="s2">&quot;LEVEL_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;persistentId&quot;</span><span class="p">:</span> <span class="s2">&quot;93E5910B-F4C2-4561-AEC5-C878AFEF25A3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;middleNames&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Rob&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;surnames&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20&quot;</span><span class="p">,</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Dou&quot;</span><span class="p">,</span>
            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;dateOfBirth&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;123 George Street&quot;</span><span class="p">],</span>
            <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
            <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
            <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;7D68E096-5510-B3844C0BA3FD&quot;</span><span class="p">,</span>
            <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10 George Street&quot;</span><span class="p">],</span>
            <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;833F1187-9F33-A7E27B3F211E&quot;</span><span class="p">,</span>
            <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;cycle3Dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;drivers_licence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;4C22DA90A18A4B88BE460E0A3D975F68&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">persistentId</span></code> is mandatory</li>
<li>you must supply at least one other value in addition to <code class="docutils literal"><span class="pre">persistentId</span></code></li>
<li>the values of <code class="docutils literal"><span class="pre">addresses</span></code> and <code class="docutils literal"><span class="pre">surnames</span></code> are arrays</li>
<li>fields have optional <code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> attributes in which you can capture historical values – for example, if the user has changed their surname, there&#8217;s an additional entry for the old surname with the <code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> values defining the period for which the name was valid; the new surname only has the <code class="docutils literal"><span class="pre">from</span></code> attribute, containing the date from which it was valid</li>
<li>the <code class="docutils literal"><span class="pre">addresses</span></code> field that holds the current address contains a <code class="docutils literal"><span class="pre">fromDate</span></code> attribute for the date from which the address is valid; past addresses also contain the <code class="docutils literal"><span class="pre">toDate</span></code> attribute</li>
<li>the <code class="docutils literal"><span class="pre">cycle3Dataset</span></code> field is only present for a cycle 3 matching attempt</li>
<li>the <code class="docutils literal"><span class="pre">uprn</span></code> (Unique Property Reference Number) is a unique reference for each property in Great Britain, ensuring accuracy of address data. This is an optional attribute that can contain up to 12 characters and should not have any leading zeros</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>When the SAML compliance tool receives your test matching dataset, it will POST an attribute query to your Matching Service Adapter. This corresponds to step 4 in the <a class="reference internal" href="samlWorks.html#samlworks"><span>SAML message flow</span></a>.</li>
<li>Your Matching Service Adapter validates the query and sends a POST with a JSON request containing your test matching dataset to your local matching service. This corresponds to step 5 in the <a class="reference internal" href="samlWorks.html#samlworks"><span>SAML message flow</span></a>.</li>
</ol>
</div>
<div class="section" id="example-of-a-json-request-to-your-local-matching-service">
<span id="samlct-jsoneg"></span><h2>Example of a JSON request to your local matching service<a class="headerlink" href="#example-of-a-json-request-to-your-local-matching-service" title="Permalink to this headline">¶</a></h2>
<p>Below is a formatted example of a cycle 3 matching request that the Matching Service Adapter sends to your local matching service:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;cycle3Dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;drivers_licence&quot;</span><span class="p">:</span> <span class="s2">&quot;4C22DA90A18A4B88BE460E0A3D975F68&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;hashedPid&quot;</span><span class="p">:</span> <span class="s2">&quot;8a5db0ad424efe4e09622cc4a876cc4c338558384752b483ff69dda4dca1ef04&quot;</span><span class="p">,</span>
    <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="s2">&quot;LEVEL_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchId&quot;</span><span class="p">:</span> <span class="s2">&quot;default-request-id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchingDataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;123 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;7D68E096-5510-B3844C0BA3FD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;10 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;833F1187-9F33-A7E27B3F211E&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;dateOfBirth&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;MALE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;middleNames&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Rob&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;surnames&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Dou&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where the <code class="docutils literal"><span class="pre">matchId</span></code> field is unique to a user&#8217;s journey in the GOV.UK Verify hub – you can log this for future reference.</p>
<p>Below is an example of a response from your local matching service:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>200 {
 result : match|no-match
 }`
</pre></div>
</div>
<p>This response corresponds to step 6 in the <a class="reference internal" href="samlWorks.html#samlworks"><span>SAML message flow</span></a>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ms/ms.html" class="btn btn-neutral float-right" title="Local Matching Service" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="samlIntegration.html" class="btn btn-neutral" title="Build your service" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
<div>Is there anything wrong with this page? Contact <a title="Contact Verify support" href="mailto:idasupport+onboarding@digital.cabinet-office.gov.uk">idasupport+onboarding@digital.cabinet-office.gov.uk</a> if you have any feedback.</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>