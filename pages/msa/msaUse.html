

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Install the Matching Service Adapter &mdash; GOV.UK Verify Technical Guide  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="GOV.UK Verify Technical Guide  documentation" href="../../index.html"/>
        <link rel="up" title="Matching Service Adapter" href="msa.html"/>
        <link rel="next" title="Public Key Infrastructure" href="../pki/pki.html"/>
        <link rel="prev" title="Matching Service Adapter" href="msa.html"/>
  <link href="../../_static/style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.4/js.cookie.js"></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-54060634-2', 'auto');
    ga('send', 'pageview');

  </script>
  <script type="text/javascript" src="../../_static/CookieBanner.js"></script>
  <script>
    $(function() {new CookieBanner("seen_cookie_message", 28, "ida-cookie-message").launch();});
  </script>


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GOV.UK Verify Technical Guide
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About this guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arch/arch.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steps/steps.html">Steps to integrate GOV.UK Verify into your service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saml/saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ms/ms.html">Local Matching Service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="msa.html">Matching Service Adapter</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Install the Matching Service Adapter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#versioning">Versioning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#obtain-certificates-for-your-matching-service-adapter">Obtain certificates for your Matching Service Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-the-matching-service-adapter">Configure the Matching Service Adapter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-yaml-configuration-file">Create a YAML configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adapt-the-yaml-configuration-file">Adapt the YAML configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#start-the-matching-service-adapter">Start the Matching Service Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitoring">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-https-proxies">Configure HTTPS Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secure-your-matching-service-adapter">Secure your Matching Service Adapter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matching-service-adapter-tls-certificates">Matching Service Adapter TLS certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connect-your-matching-service-adapter-to-the-internet-securely">Connect your Matching Service Adapter to the internet securely</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pki/pki.html">Public Key Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/env.html">GOV.UK Verify environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shared/glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vershis/vershis.html">Version history</a></li>
<li class="toctree-l1"><a class="reference external" href="http://rp-environment-request.ida.digital.cabinet-office.gov.uk/contact_form">Contact us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GOV.UK Verify Technical Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="msa.html">Matching Service Adapter</a> &raquo;</li>
      
    <li>Install the Matching Service Adapter</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="install-the-matching-service-adapter">
<span id="msa-install-msa"></span><span id="msause"></span><h1>Install the Matching Service Adapter<a class="headerlink" href="#install-the-matching-service-adapter" title="Permalink to this headline">¶</a></h1>
<p><strong>Prerequisite:</strong> The Matching Service Adapter (MSA) requires Java 8. Make sure you have the latest version of the JRE (Java Runtime Environment) installed.</p>
<ol class="arabic simple">
<li>When you have successfully completed a gate review for <a class="reference external" href="http://alphagov.github.io/identity-assurance-documentation/stage3/Stage3.html">Stage 3: Planning</a>, email <a class="reference external" href="mailto:idasupport+onboarding&#37;&#52;&#48;digital&#46;cabinet-office&#46;gov&#46;uk">idasupport+onboarding<span>&#64;</span>digital<span>&#46;</span>cabinet-office<span>&#46;</span>gov<span>&#46;</span>uk</a> to request access to the secure site where you can download the MSA.</li>
<li>Download the MSA to your host. It contains:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>a jar (java archive) file</li>
<li>a <a class="reference internal" href="../../shared/glossary.html#gloss-truststore"><span>truststore</span></a> file and a metadata truststore file for non-production environments (the SAML compliance tool and the integration environment)</li>
<li>a truststore file and a metadata truststore file for the production environment</li>
</ul>
</div></blockquote>
<ol class="arabic" start="3">
<li><p class="first">To extract the files and move the truststore files to the environment where you want to use the MSA, run the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>tar -xf [filename].tar.gz
unzip ida-msa-[xxx].zip
mv prod_ida_truststore.ts prod_ida_metadata_truststore.ts [path to truststore directory in the production environment]
mv test_ida_truststore.ts test_ida_metadata_truststore.ts [path to truststore directory in the integration environment]
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">[filename]</span></code> is the name of the tar file</li>
<li><code class="docutils literal"><span class="pre">[xxx]</span></code> is the build number</li>
<li><code class="docutils literal"><span class="pre">[path</span> <span class="pre">to</span> <span class="pre">truststore</span> <span class="pre">directory...]</span></code> is the location of the truststore – you specify this when configuring the MSA (see the configuration options <code class="docutils literal"><span class="pre">storeUri:</span></code> and <code class="docutils literal"><span class="pre">trustStorePath:</span></code> in the <a class="reference internal" href="#yamlfile"><span>YAML file</span></a>)</li>
</ul>
</div></blockquote>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>Typically, GOV.UK Verify releases a new version of the MSA every 2 or 3 months. Some releases are essential updates, and we may remove support for older versions. To keep updated, contact the <a class="reference external" href="mailto:idasupport+onboarding&#37;&#52;&#48;digital&#46;cabinet-office&#46;gov&#46;uk">GOV<span>&#46;</span>UK Verify support team</a> to ensure you are on the MSA email distribution list.</p>
</div>
</div>
<div class="section" id="obtain-certificates-for-your-matching-service-adapter">
<span id="msa-certs"></span><h1>Obtain certificates for your Matching Service Adapter<a class="headerlink" href="#obtain-certificates-for-your-matching-service-adapter" title="Permalink to this headline">¶</a></h1>
<p>Your MSA needs a signing certificate and an encryption certificate. You must use different certificates for each environment.</p>
<p>To obtain certificates:</p>
<ul class="simple">
<li><a class="reference internal" href="../saml/samlComplianceTool.html#samlctselfsigncert"><span>generate self-signed certificates</span></a> for use with the compliance tool</li>
<li><a class="reference internal" href="../pki/pkiRequestCert.html#pkirequestcert"><span>request certificates</span></a> from the IDAP certificate authority for the integration and production environments</li>
</ul>
</div>
<div class="section" id="configure-the-matching-service-adapter">
<span id="configuremsa"></span><h1>Configure the Matching Service Adapter<a class="headerlink" href="#configure-the-matching-service-adapter" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-a-yaml-configuration-file">
<h2>Create a YAML configuration file<a class="headerlink" href="#create-a-yaml-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>When you <a class="reference internal" href="#msa-test-msa"><span>start the Matching Service Adapter</span></a>, you need to supply a YAML configuration file.</p>
<p>Create a YAML configuration file based on the example below. Then <a class="reference internal" href="#msa-adapt-yaml"><span>adapt it</span></a> for the SAML compliance tool or appropriate environment.</p>
<div class="highlight-python" id="yamlfile"><div class="highlight"><pre><span></span>server:
 applicationConnectors:
   - type: http
     port: 50210
 adminConnectors:
   - type: http
     port: 50211
 requestLog:
   appenders:
     - type: file
       currentLogFilename: apps-home/msa.log
       archivedLogFilenamePattern: apps-home/msa.log.%d.gz
       logFormat: &#39;%-5p [%d{ISO8601,UTC}] %c: %m%n%xEx&#39;
     - type: logstash-file
       currentLogFilename: apps-home/logstash/msa.log
       archivedLogFilenamePattern: apps-home/logstash/msa.log.%d.gz
       archivedFileCount: 7
     - type: console

logging:
 level: INFO
 appenders:
   - type: file
     currentLogFilename: apps-home/msa.log
     archivedLogFilenamePattern: apps-home/msa.log.%d.gz
     logFormat: &#39;%-5p [%d{ISO8601,UTC}] %c: %X{logPrefix}%m%n%xEx&#39;
   - type: logstash-file
     currentLogFilename: apps-home/logstash/msa.log
     archivedLogFilenamePattern: apps-home/logstash/msa.log.%d.gz
     archivedFileCount: 7
   - type: console
     logFormat: &#39;%-5p [%d{ISO8601,UTC}] %c: %X{logPrefix}%m%n%xEx&#39;

assertionLifetime: 60m
matchingServiceUri: http://local-matching-service.my.service.gov.uk/matching-request
unknownUserCreationServiceUri: http://local-matching-service.my.service.gov.uk/unknown-user-request

matchingServiceAdapterLocation: http://matching-service-adapter.my.service.gov.uk/matching-service/POST

saml:
 entityId: http://matching-service-adapter.my.service.gov.uk/matching-service

matchingServiceClient:
 timeout: 2s
 timeToLive: 10m
 cookiesEnabled: false
 connectionTimeout: 1s

metadata:
 uri: https://www.[your-env].signin.service.gov.uk/SAML2/metadata/federation
 trustStorePath: [path to truststore directory...]/ida_metadata_truststore.ts
 trustStorePassword: puppet
 expectedEntityId: https://signin.service.gov.uk
 maxRefreshDelay: 100000
 minRefreshDelay: 10000
 client:
   timeout: 2s
   timeToLive: 10m
   cookiesEnabled: false
   connectionTimeout: 1s
   retries: 3
   keepAlive: 60s
   chunkedEncodingEnabled: false
   validateAfterInactivityPeriod: 5s
   tls:
     protocol: TLSv1.2
     verifyHostname: true
     trustSelfSignedCertificates: false

hubSSOUri: https://www.[your-env].signin.service.gov.uk/SAML2/SSO

requireHubCertificates: false

serviceInfo:
 name: matching-service-adapter

# If you would like the MSA to report to a Graphite instance.
metrics:
 reporters:
   - type: graphite
     host: [graphite host]
     port: [graphite port]
     prefix: [some prefix of your choosing]
     frequency: 30s

privateSigningKeyConfiguration:
 keyUri: [path to your keys directory...]/msa_signing.pk8

privateEncryptionKeyConfiguration:
 keyUri: [path to your keys directory...]/msa_encryption.pk8

publicSigningKeyConfiguration:
 keyUri: [path to your keys directory...]/msa_signing.crt
 keyName: http://matching-service-adapter.my.service.gov.uk/matching-service

publicEncryptionKeyConfiguration:
 keyUri: [path to your keys directory...]/msa_encryption.crt
 keyName: http://matching-service-adapter.my.service.gov.uk/matching-service

publicSecondarySigningKeyConfiguration
 keyUri: [path to your keys directory...]/msa_signing_secondary.crt
 keyName: http://matching-service-adapter.my.service.gov.uk/matching-service-secondary-sigining

publicSecondaryEncryptionKeyConfiguration
 keyUri: [path to your keys directory...]/msa_encryption_secondary.crt
 keyName: http://matching-service-adapter.my.service.gov.uk/matching-service-secondary-encryption

returnStackTraceInResponse: false

clientTrustStoreConfiguration:
 storeUri: [path to truststore directory...]/ida_truststore.ts
 password: puppet

featureFlagConfiguration:
 isCertificateChainValidationRequired: true
 encryptionDisabled: false
</pre></div>
</div>
</div>
<div class="section" id="adapt-the-yaml-configuration-file">
<span id="msa-adapt-yaml"></span><h2>Adapt the YAML configuration file<a class="headerlink" href="#adapt-the-yaml-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>Make the following changes to the YAML configuration file. Variations are indicated where appropriate for the SAML compliance tool and integration and production environments.</p>
<ol class="arabic simple">
<li>Enter port numbers for the server application and admin ports.</li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the MSA will be handling SSL termination (typically this will be handled by a proxy/load balancer like HAProxy), or if you don&#8217;t trust the network between the SSL termination endpoint and the MSA, then specify <code class="docutils literal"><span class="pre">https</span></code> rather than <code class="docutils literal"><span class="pre">http</span></code> for the type of connection. For more information, see the guidance in the <a class="reference external" href="http://dropwizard.github.io/dropwizard/0.8.2/docs/manual/configuration.html#https">DropWizard configuration manual</a>.</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Enter the URIs for your matching service and MSA in <code class="docutils literal"><span class="pre">matchingServiceUri:</span></code> and <code class="docutils literal"><span class="pre">matchingServiceAdapterLocation:</span></code> respectively.</li>
<li>If you&#8217;re creating new user accounts when a match is not found (see <a class="reference internal" href="../ms/msCua.html#ms-cua"><span>Create user accounts</span></a>), enter the user account creation URI in <code class="docutils literal"><span class="pre">unknownUserCreationServiceUri:</span></code></li>
<li>In <code class="docutils literal"><span class="pre">entity</span> <span class="pre">id</span></code>, enter the entityID for the MSA in URI format. You create your own URI, possibly to reflect the name of your service, for example: <code class="docutils literal"><span class="pre">https://&lt;service</span> <span class="pre">name&gt;/MSA</span></code></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It&#8217;s good practice to use the MSA&#8217;s URI (that is, the URI where the hub will send matching requests) as its entity ID, but this isn&#8217;t mandatory.</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="5">
<li>In <code class="docutils literal"><span class="pre">metadata:</span></code>, use the <code class="docutils literal"><span class="pre">uri:</span></code> parameter to specify the location where the MSA accesses the SAML metadata:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>for the SAML compliance tool, your GOV.UK Verify engagement lead will give you the URL</li>
<li>for the integration environment, enter: <code class="docutils literal"><span class="pre">https://www.integration.signin.service.gov.uk/SAML2/metadata/federation</span></code></li>
<li>for the production environment, enter: <code class="docutils literal"><span class="pre">https://www.signin.service.gov.uk/SAML2/metadata/federation</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>In <code class="docutils literal"><span class="pre">metadata:</span></code>, use the <code class="docutils literal"><span class="pre">trustStorePath:</span></code> parameter to specify the path to your metadata truststore for the appropriate environment:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>for the SAML compliance tool and the integration environment, use <code class="docutils literal"><span class="pre">test_metadata_truststore.ts</span></code></li>
<li>for the production environment, use <code class="docutils literal"><span class="pre">prod_metadata_truststore.ts</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li>In <code class="docutils literal"><span class="pre">clientTrustStoreConfiguration:</span></code>, use the <code class="docutils literal"><span class="pre">storeUri</span></code> parameter to specify the path of your general truststore for the appropriate environment:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>for the SAML compliance tool and the integration environment, use <code class="docutils literal"><span class="pre">test_ida_truststore.ts</span></code></li>
<li>for the production environment, use <code class="docutils literal"><span class="pre">prod_ida_truststore.ts</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="8">
<li>Enter the paths of the SAML signing and encryption private keys for your MSA:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">privateSigningKeyConfiguration:</span></code> – PKCS#8 DER formatted</li>
<li><code class="docutils literal"><span class="pre">privateEncryptionKeyConfiguration:</span></code> – PKCS#8 DER formatted</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To convert a private key to PKCS#8 DER format, run the following command: <code class="docutils literal"><span class="pre">openssl</span> <span class="pre">pkcs8</span> <span class="pre">-topk8</span> <span class="pre">-nocrypt</span> <span class="pre">-in</span> <span class="pre">server.key</span> <span class="pre">-out</span> <span class="pre">server.pk8</span> <span class="pre">-outform</span> <span class="pre">DER</span></code></p>
</div>
<p>For the compliance tool, <a class="reference internal" href="../saml/samlComplianceTool.html#samlctselfsigncert"><span>generate self-signed certificates</span></a>.</p>
<p>You will use different keys and certificates for the integration and production environments. See <a class="reference internal" href="../pki/pkiRequestCert.html#pkirequestcert"><span>Request certificates</span></a>.</p>
</div></blockquote>
<ol class="arabic simple" start="9">
<li>Enter the paths and names of the SAML signing and encryption certificates for your MSA.  The names are used to identify the certificates in the metadata so should be meaningful and unique:  <code class="docutils literal"><span class="pre">signing_1</span></code> and <code class="docutils literal"><span class="pre">encryption_1</span></code> would be acceptable.</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">publicSigningKeyConfiguration:</span></code> – public signing certificate, PEM formatted</li>
<li><code class="docutils literal"><span class="pre">publicEncryptionKeyConfiguration:</span></code> – public encryption certificate, PEM formatted</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="10">
<li>If you want to use Graphite software to monitor the MSA’s performance (optional), supply the required metrics: type, host, port, prefix and frequency of the reporter.</li>
</ol>
</div>
</div>
<div class="section" id="start-the-matching-service-adapter">
<span id="msa-test-msa"></span><h1>Start the Matching Service Adapter<a class="headerlink" href="#start-the-matching-service-adapter" title="Permalink to this headline">¶</a></h1>
<p>To start using the MSA, run the following command, supplying the path to your configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>java -jar [filename].jar server [path to configuration file].yml
</pre></div>
</div>
<p>You can now run <a class="reference internal" href="../saml/samlComplianceTool.html#samlcthubmsa"><span>SAML compliance tests between the hub and your MSA</span></a>. To help <a class="reference internal" href="../ms/msBuild.html#msbuild"><span>build your local matching service</span></a>, you can use the <a class="reference internal" href="../saml/samlComplianceTool.html#samlct-jsoneg"><span>example of the JSON request</span></a> that the MSA posts to your service.</p>
</div>
<div class="section" id="monitoring">
<h1>Monitoring<a class="headerlink" href="#monitoring" title="Permalink to this headline">¶</a></h1>
<p>Health checks run every 60 seconds to ensure that the MSA is functioning correctly. They test:</p>
<ul class="simple">
<li>connectivity</li>
<li>that the MSA accepts the hub signature</li>
<li>that the hub accepts the MSA signature</li>
</ul>
</div>
<div class="section" id="configure-https-proxies">
<h1>Configure HTTPS Proxies<a class="headerlink" href="#configure-https-proxies" title="Permalink to this headline">¶</a></h1>
<p>The MSA supports HTTP and HTTPS proxies configured by Java properties.</p>
<p>For information on configuring HTTPS proxies, see <a class="reference external" href="http://docs.oracle.com/javase/8/docs/technotes/guides/net/proxies.html">http://docs.oracle.com/javase/8/docs/technotes/guides/net/proxies.html</a>.</p>
</div>
<div class="section" id="secure-your-matching-service-adapter">
<h1>Secure your Matching Service Adapter<a class="headerlink" href="#secure-your-matching-service-adapter" title="Permalink to this headline">¶</a></h1>
<div class="section" id="matching-service-adapter-tls-certificates">
<h2>Matching Service Adapter TLS certificates<a class="headerlink" href="#matching-service-adapter-tls-certificates" title="Permalink to this headline">¶</a></h2>
<p>GOV.UK Verify trusts the following root certificate authorities for HTTPS connections to your matching service:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="23%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Root certificate authority</th>
<th class="head">Common name</th>
<th class="head">X509v3 subject key identifier</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AddTrust External CA Root</td>
<td>AddTrust External CA Root</td>
<td>AD:BD:98:7A:34:B4:26:F7:FA:C4:26:54:EF:03:BD:E0:24:CB:54:1A</td>
</tr>
<tr class="row-odd"><td>GeoTrust Global CA</td>
<td>GeoTrust Global CA</td>
<td>C0:7A:98:68:8D:89:FB:AB:05:64:0C:11:7D:AA:7D:65:B8:CA:CC:4E</td>
</tr>
<tr class="row-even"><td>QuoVadis Root CA 2</td>
<td>QuoVadis Root CA 2</td>
<td>1A:84:62:BC:48:4C:33:25:04:D4:EE:D0:F6:03:C4:19:46:D1:94:6B</td>
</tr>
</tbody>
</table>
<p>If you want to use a root certificate authority for your matching service that isn’t in the above table, raise a ticket with us by sending an email to <a class="reference external" href="mailto:idasupport+onboarding&#37;&#52;&#48;digital&#46;cabinet-office&#46;gov&#46;uk">idasupport+onboarding<span>&#64;</span>digital<span>&#46;</span>cabinet-office<span>&#46;</span>gov<span>&#46;</span>uk</a>. We’ll review your chosen root certificate authority before adding it to this list.</p>
<p>When you raise a ticket, indicate the chain of trust with your SSL/TLS certificate. You will also need the chain of trust when you configure your server.</p>
</div>
<div class="section" id="connect-your-matching-service-adapter-to-the-internet-securely">
<h2>Connect your Matching Service Adapter to the internet securely<a class="headerlink" href="#connect-your-matching-service-adapter-to-the-internet-securely" title="Permalink to this headline">¶</a></h2>
<p>Your MSA must only respond to matching requests from the GOV.UK Verify hub, otherwise there’s a risk of user data being compromised.</p>
<p>The MSA checks that matching service requests are genuine by checking their cryptographic signatures.</p>
<p>To ensure that only the GOV.UK Verify hub can access the MSA, make sure your MSA:</p>
<ul>
<li><p class="first">is only exposed as HTTPS endpoints</p>
</li>
<li><p class="first">only uses strong recent versions of TLS (for example TLS 1.2); turn off obsolete and insecure versions (for example SSLv1, SSLv2, and SSLv3)</p>
</li>
<li><p class="first">supports multiple strong cipher suites</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">GOV.UK Verify will remove support for TLS cipher suites if serious weaknesses become known. Having multiple suites provides resilience.</p>
</div>
</li>
<li><p class="first">allows requests and health checks only from the IP addresses of hub services provided by your engagement lead</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each MSA should communicate with only 1 hub service (SAML compliance tool, integration environment, or production environment).</p>
</div>
</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pki/pki.html" class="btn btn-neutral float-right" title="Public Key Infrastructure" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="msa.html" class="btn btn-neutral" title="Matching Service Adapter" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
<div>Is there anything wrong with this page? Contact <a title="Contact Verify support" href="mailto:idasupport+onboarding@digital.cabinet-office.gov.uk">idasupport+onboarding@digital.cabinet-office.gov.uk</a> if you have any feedback.</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>