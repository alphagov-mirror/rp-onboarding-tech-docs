

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Build a local matching service &mdash; GOV.UK Verify Technical Guide  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="GOV.UK Verify Technical Guide  documentation" href="../../index.html"/>
        <link rel="up" title="Local Matching Service" href="ms.html"/>
        <link rel="next" title="Create user accounts" href="msCua.html"/>
        <link rel="prev" title="How a matching service works" href="msWorks.html"/>
  <link href="../../_static/style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.4/js.cookie.js"></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-54060634-2', 'auto');
    ga('send', 'pageview');

  </script>
  <script type="text/javascript" src="../../_static/CookieBanner.js"></script>
  <script>
    $(function() {new CookieBanner("seen_cookie_message", 28, "ida-cookie-message").launch();});
  </script>


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GOV.UK Verify Technical Guide
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">About this guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arch/arch.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steps/steps.html">Steps to integrate GOV.UK Verify into your service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saml/saml.html">SAML</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ms.html">Local Matching Service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="msWorks.html">How a matching service works</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Build a local matching service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-your-matching-strategy">Define your matching strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#matching-considerations">Matching considerations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#respond-to-json-matching-requests">Respond to JSON matching requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-a-json-schema">Use a JSON schema</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="msCua.html">Create user accounts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../msa/msa.html">Matching Service Adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pki/pki.html">Public Key Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/env.html">GOV.UK Verify environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shared/glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vershis/vershis.html">Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">GOV.UK Verify Technical Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="ms.html">Local Matching Service</a> &raquo;</li>
      
    <li>Build a local matching service</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="build-a-local-matching-service">
<span id="msbuild"></span><h1>Build a local matching service<a class="headerlink" href="#build-a-local-matching-service" title="Permalink to this headline">¶</a></h1>
<p>Even if your service doesn’t need to perform matching, you must still build a local matching service because it also:</p>
<ul class="simple">
<li>creates the <a class="reference internal" href="../../shared/glossary.html#gloss-hashpid"><span>hashed persistent identifier</span></a></li>
<li>creates and signs the final assertion sent to your service - for more information, see <a class="reference internal" href="../saml/samlWorks.html#samlworks"><span>How SAML works with GOV.UK Verify</span></a></li>
<li>acts as the <a class="reference internal" href="../../shared/glossary.html#gloss-trustanchor"><span>trust anchor</span></a> for your service because the final assertion is created in your service&#8217;s security domain</li>
</ul>
<div class="section" id="define-your-matching-strategy">
<span id="ms-strat"></span><h2>Define your matching strategy<a class="headerlink" href="#define-your-matching-strategy" title="Permalink to this headline">¶</a></h2>
<p>A matching strategy defines the most efficient and effective way of matching assured identities to your service records. The strategy depends on the quality and completeness of available data sources and the types of evidence users can provide.</p>
<p>A local matching service carries out a risk-based match to find the local record. Exact matching of identity data is rarely possible for many reasons:</p>
<ul class="simple">
<li>transcription errors</li>
<li>spelling mistakes</li>
<li>incorrect data in your service&#8217;s data sources, for example, if someone has moved house but not informed the service</li>
<li>use of shortened names or nicknames which refer to the same person, for example, William Smith, Bill Smith and David William Smith</li>
</ul>
<p>Your local matching service must be able to handle these issues. You may decide to:</p>
<ul class="simple">
<li>widen the initial query to make sure that relevant records are not missed, then narrow the query on the results to make sure false positives are not returned; for example, search for last name, date of birth, and postcode, then run further matching on the results and apply a confidence score</li>
<li>try synonym matching against combinations of first name and last name, possibly transposing them to maximise the chances of finding a match</li>
</ul>
<div class="section" id="matching-considerations">
<h3>Matching considerations<a class="headerlink" href="#matching-considerations" title="Permalink to this headline">¶</a></h3>
<p>When you define your matching strategy you need to:</p>
<ul class="simple">
<li>prepare for matching with customer data aggregation and data cleansing</li>
<li>define the confidence level required for a successful match and how to score the confidence level, for example:<ul>
<li>100% match confidence means that all elements from the matching dataset fully match the local record</li>
<li>80% match confidence might mean that the first name, last name, and date of birth match, but the address is showing a mismatch</li>
</ul>
</li>
<li>define the rules for successful matching, which may include what to do with:<ul>
<li>synonyms for first names, for example, <strong>William</strong> and <strong>Bill</strong></li>
<li>transpositions of multiple part names, for example, <strong>Anna-Marie</strong>, <strong>Jane</strong> and <strong>Anna, Marie-Jane</strong></li>
<li>transpositions of errors of day and month in the date of birth, for example, <strong>04/10/78</strong> and <strong>10/04/78</strong></li>
</ul>
</li>
<li>define the level of &#8216;fuzzy matching&#8217; that is acceptable when an exact match is not found – this allows a match that, although not 100%, is above a service-defined threshold</li>
<li>manage the risk of incorrect matching by defining what happens when:<ul>
<li>there&#8217;s no match – you can <a class="reference internal" href="msCua.html#ms-cua"><span>create a new account</span></a> for the user</li>
<li>there are multiple matches – you can implement <a class="reference internal" href="msWorks.html#ms-mc3"><span>matching cycle 3</span></a></li>
</ul>
</li>
<li>analyse your data sources in the light of your matching strategy, so you can test and refine your strategy before launching alpha or beta services</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We recommend that you discuss your matching strategy with your engagement lead. They can organise technical support if needed.</p>
</div>
</div>
</div>
<div class="section" id="respond-to-json-matching-requests">
<span id="respondjsonmr"></span><h2>Respond to JSON matching requests<a class="headerlink" href="#respond-to-json-matching-requests" title="Permalink to this headline">¶</a></h2>
<p>Your service must respond to JSON matching requests from the matching service adapter (MSA). The MSA makes requests to the URLs specified in the <a class="reference internal" href="../msa/msaUse.html#yamlfile"><span>YAML configuration file</span></a>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">localMatchingService:</span></code> <code class="docutils literal"><span class="pre">matchUrl:</span></code></li>
<li><code class="docutils literal"><span class="pre">localMatchingService:</span></code> <code class="docutils literal"><span class="pre">accountCreationUrl:</span></code> (if you&#8217;re <a class="reference internal" href="msCua.html#ms-cua"><span>creating new user accounts</span></a> when a match is not found)</li>
</ul>
<p>The MSA sends one matching request for both cycle 0 and cycle 1 to your local matching service. Below is a formatted example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;hashedPid&quot;</span><span class="p">:</span> <span class="s2">&quot;8a5db0ad424efe4e09622cc4a876cc4c338558384752b483ff69dda4dca1ef04&quot;</span><span class="p">,</span>
    <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="s2">&quot;LEVEL_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchId&quot;</span><span class="p">:</span> <span class="s2">&quot;default-request-id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchingDataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;123 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;7D68E096-5510-B3844C0BA3FD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;10 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;833F1187-9F33-A7E27B3F211E&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;dateOfBirth&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;MALE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;middleNames&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Rob&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;surnames&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Dou&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Your local matching service first runs cycle 0. If no match is found, it runs cycle 1. It then sends either a <code class="docutils literal"><span class="pre">match</span></code> or a <code class="docutils literal"><span class="pre">no-match</span></code> response to the MSA. This response corresponds to step 6 in the <a class="reference internal" href="../saml/samlWorks.html#samlworks"><span>SAML message flow</span></a>.</p>
<p>Below is a <code class="docutils literal"><span class="pre">match</span></code> response (it should have the status code <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span><span class="s2">&quot;match&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Below is a <code class="docutils literal"><span class="pre">no-match</span></code> response (it should have the status code <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span><span class="s2">&quot;no-match&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>If you&#8217;re using cycle 3 and your local matching service returned a <code class="docutils literal"><span class="pre">no-match</span></code> response to the MSA, the MSA sends a cycle 3 matching request.  Below is a formatted example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;cycle3Dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;drivers_licence&quot;</span><span class="p">:</span> <span class="s2">&quot;4C22DA90A18A4B88BE460E0A3D975F68&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;hashedPid&quot;</span><span class="p">:</span> <span class="s2">&quot;8a5db0ad424efe4e09622cc4a876cc4c338558384752b483ff69dda4dca1ef04&quot;</span><span class="p">,</span>
    <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="s2">&quot;LEVEL_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchId&quot;</span><span class="p">:</span> <span class="s2">&quot;default-request-id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;matchingDataset&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;123 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;7D68E096-5510-B3844C0BA3FD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2005-05-14T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;10 George Street&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="s2">&quot;GB1 2PF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="s2">&quot;833F1187-9F33-A7E27B3F211E&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;dateOfBirth&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;MALE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;middleNames&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Rob&quot;</span><span class="p">,</span>
            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;surnames&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;1980-05-24T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;2010-01-20T00:00:00.000Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Dou&quot;</span><span class="p">,</span>
                <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Your local matching service sends either a <code class="docutils literal"><span class="pre">match</span></code> or a <code class="docutils literal"><span class="pre">no-match</span></code> response to the MSA. This response corresponds to step 6 in the <a class="reference internal" href="../saml/samlWorks.html#samlworks"><span>SAML message flow</span></a>.</p>
<p>If no match is found on cycles 0, 1 and 3, you can <a class="reference internal" href="msCua.html#ms-cua"><span>create a new account</span></a> for the user.</p>
</div>
<div class="section" id="use-a-json-schema">
<h2>Use a JSON schema<a class="headerlink" href="#use-a-json-schema" title="Permalink to this headline">¶</a></h2>
<p id="jsonschema">Below is a <a class="reference external" href="http://json-schema.org/">JSON schema</a> for a matching request. You can use this schema to validate incoming matching requests and as a reference when developing your local matching service.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The elements in <code class="docutils literal"><span class="pre">matchingDataset</span></code> are optional, so the code handling this in your local matching service must be appropriately flexible.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;cycle3Dataset&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;hashedPid&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;LEVEL_1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LEVEL_2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LEVEL_3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LEVEL_4&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;matchId&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;matchingDataset&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;fromDate&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;internationalPostCode&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                                <span class="p">},</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;postCode&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;toDate&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;uprn&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;dateOfBirth&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;FEMALE&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;MALE&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;NOT_SPECIFIED&quot;</span>
                            <span class="p">],</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;middleNames&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;surnames&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE_TIME&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">},</span>
                            <span class="s2">&quot;verified&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;matchId&quot;</span><span class="p">,</span> <span class="s2">&quot;levelOfAssurance&quot;</span><span class="p">,</span> <span class="s2">&quot;hashedPid&quot;</span><span class="p">,</span> <span class="s2">&quot;matchingDataset&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="msCua.html" class="btn btn-neutral float-right" title="Create user accounts" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="msWorks.html" class="btn btn-neutral" title="How a matching service works" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
<div>Is there anything wrong with this page? Contact <a title="Contact Verify support" href="mailto:idasupport+onboarding@digital.cabinet-office.gov.uk">idasupport+onboarding@digital.cabinet-office.gov.uk</a> if you have any feedback.</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>